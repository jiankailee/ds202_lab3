---
title: "ds202_lab3"
author: "Jian Kai Lee;jiankailee"
date: "2/19/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

 problem 1,3,5,7 
```{r fig.width=15, fig.height=10}
library(ggplot2)
library(ggmosaic)
dat <- readxl::read_xls('GSS.xls')
dat1<-as.data.frame(dat)
names(dat1)<-c('year','id','labor','hours','married','sex','political','happiness','ballot')
head(dat1)

#1 How does the happiness of a respondent relate to the marriage status?
dat2<-dat1[!is.na(dat1$married),]
ggplot(dat2,aes(x=married))+geom_bar(aes(fill=happiness),position="fill")


#3 How does the happiness of a respondent relate to the political party affiliation?
dat2<-dat1[!is.na(dat1$political),]
ggplot(dat2,aes(x=political))+geom_bar(aes(fill=happiness),position="fill")

# 5 happiness vs labor
dat2<-dat1[!is.na(dat1$labor),]
ggplot(dat2)+geom_mosaic(aes(x=product(labor),fill=happiness))
unique(dat2$labor)
#ggplot(dat1)+geom_mosaic(aes(x=product(sex),fill=happiness))+facet_grid(married)

# year vs political party
dat2<-dat1[!is.na(dat1$year),]
dat2<-dat2[dat2$year==2018,]
head(dat2$year)
ggplot(dat2)+geom_mosaic(aes(x=product(year),fill=political))+facet_grid(sex~married)
#ggplot(dat2,aes(x=dat2$year))+geom_bar(aes(fill=political))
unique(dat2$year)
```
1 To find the relationship between the happiness of a respondent and marrage status, we use precent stacked barchart to reveal the percentage of each happiness in each married status. First, we filter out the married status that are NA. After that, we use ggplot barchart plot with x to married status and fill each bar with happiness. We also set the position to fill to display the percent of each happiness in each bar. In bar plot, the married has the highest percentage of "very happy" happiness compared to other. The separated status in married has the lowest percentage among all. For the "not too happy" happiness, the seperated has the highest rate. In the married status, total of pretty happy and very happy has the highest rate compared to other. From here, we can see the relationship the married status or never married are higher happiness than those divorced, separated or widowed status.

3 To find the relationship between happiness and political party, we use percent stacked bar plot to show the happiness of each political party. On the x axis, we display political party, y axis show the percentage and fill each bar with happiness. In the plot, we can see the respondents have no political party affiliation tend to be very happy than other who have political affiliation. The percentage of happy which include "pretty happy" and "very happy" of each political party are quite close to 0.75 count. There is no significant show which political party is more happy. In the other side, no political party preferred respondents have the higest rate of not too happy among all. 

5 How does the happiness ratio in each of working status in the dataset and the ratio of labor status in the dataset ? 
To see the happiness ratio and the labor status ratio in the dataset, we use ggplot with matrix mosaic plot x axis filled with labor and each bar filled with happiness. From the plot, we can see our data set contain a higher ratio of working full respondents, second are keeping house and retired respondents. In addition, there are small amount of respondents in "School", "Temporary not working", "unemploy and laid" and Other. In each bar of labor status, the ratio of very happy in quite the same among all labor status except the Unemploy has the lowest ratio and approximately half of working full less in terms of very happy. Similarly to respondent answered "other",it has a low very happy ratio. "Unemploy, laid out" has the high ratio of "not too happy" compared to other. In the plot, it show the ratio of happiness in each labor status and the comparison of happiness in all labor status.

7 What are the ratio of political affiliation in each sex and married status in 2018?
First, we filter out the NA value in year in the data set and extract the data only in 2018. We then use ggplot with masaic and facet grid to show the matrix. x variable in mosaic is year and and filled with political affiliation. The matrix grid are sex vs married. In the plot, we the political ratio of each married status and sex. From the plot, we can see in the widowed married have the largest ratio pf strong democrat in female and male and compared to other.


